<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ö–∞–¥—Ä–æ–≤–∏–π –∞—É–¥–∏—Ç</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        input, select, button {
            margin: 8px 0;
            padding: 8px;
            width: 100%;
            border-radius: 6px;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìã –ö–∞–¥—Ä–æ–≤–∏–π –∞—É–¥–∏—Ç</h1>
        <p>üë§ –í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫ <strong>{{ username }}</strong></p>
        <a href="/logout">üö™ –í–∏–π—Ç–∏</a>
        <hr>

        <form method="POST">
            <label for="user_search">üîç –ü–æ—à—É–∫ –ø–æ –Ω—ñ–∫—É:</label>
            <input type="text" id="user_search" oninput="filterUsers()">

            <label for="user_id">üë§ –û–±–µ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</label>
            <select name="user_id" id="user_select" required>
                {% for name, uid in members %}
                    <option value="{{ uid }}">{{ name }}</option>
                {% endfor %}
            </select>

            <label for="action">‚öôÔ∏è –î—ñ—è:</label>
            <select name="action" id="action" onchange="toggleRoleSelect()" required>
                <option value="promote">–ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è</option>
                <option value="demote">–ü–æ–Ω–∏–∂–µ–Ω–Ω—è</option>
                <option value="kick">–í–∏–≥–Ω–∞–Ω–Ω—è</option>
                <option value="join">–©–æ–π–Ω–æ –≤—Å—Ç—É–ø–∏–≤</option>
            </select>

            <div id="role_block">
                <label for="role_id">üéñÔ∏è –ù–æ–≤–∞ —Ä–æ–ª—å:</label>
                <select name="role_id">
                    {% for name, rid in roles %}
                        <option value="{{ rid }}">{{ name }}</option>
                    {% endfor %}
                </select>
            </div>

            <label for="reason">üìù –ü—Ä–∏—á–∏–Ω–∞:</label>
            <input type="text" name="reason" required>

            <label for="author">‚úçÔ∏è –ê–≤—Ç–æ—Ä –¥—ñ—ó:</label>
            <input type="text" name="author" required>

            <button type="submit">‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
        </form>
    </div>

    <script>
        function toggleRoleSelect() {
            const action = document.getElementById("action").value;
            document.getElementById("role_block").style.display = (action === "kick" || action === "join") ? "none" : "block";
        }

        function filterUsers() {
            const input = document.getElementById("user_search").value.toLowerCase();
            const select = document.getElementById("user_select");
            for (const option of select.options) {
                option.style.display = option.text.toLowerCase().includes(input) ? "block" : "none";
            }
        }

        toggleRoleSelect();
    </script>
</body>
</html>
