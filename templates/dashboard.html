<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>üìã Dashboard | National Guard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
   <style>
    body {
        background: url('/static/bg.jpg') no-repeat center center fixed;
        background-size: cover;
        color: #fff;
    }
    .form-container {
        background-color: rgba(20, 20, 20, 0.85);
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    }
    label {
        margin-top: 10px;
        color: #f8f9fa;
    }
    .form-control, .form-select {
        background-color: #f8f9fa;
        color: #000;
    }
    .form-control::placeholder {
        color: #6c757d;
    }

    /* FIX: —á–æ—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç —É –≤–∏–ø–∞–¥–∞—é—á–æ–º—É —Å–ø–∏—Å–∫—É Select2 */
    .select2-results__option {
        color: #000 !important;
        background-color: #fff !important;
    }
    .select2-container--default .select2-selection--single {
        background-color: #f8f9fa;
        color: #000;
    }
    .select2-selection__rendered {
        color: #000 !important;
    }
</style>

</head>
<body>
<div class="container py-5">
    <div class="form-container">
        <h2 class="mb-4 text-center">üìã –ü–∞–Ω–µ–ª—å –∫–∞–¥—Ä–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç—É</h2>
        <form method="POST">
            <label for="user_id">üéØ –û–±–µ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</label>
            <select class="form-select js-user-select" name="user_id" required>
                {% for name, uid in members %}
                    <option value="{{ uid }}">{{ name }}</option>
                {% endfor %}
            </select>

            <label for="action">üìå –û–±–µ—Ä—ñ—Ç—å –¥—ñ—é:</label>
            <select class="form-select" name="action" id="action" onchange="toggleRoleField()" required>
                <option value="–ü—Ä–∏–π–Ω—è—Ç–æ">‚úÖ –ü—Ä–∏–π–Ω—è—Ç–æ</option>
                <option value="–ó–º—ñ–Ω–∞ —Ä–∞–Ω–≥—É">üéñÔ∏è –ó–º—ñ–Ω–∞ —Ä–∞–Ω–≥—É</option>
                <option value="–í–∏–≥–Ω–∞–Ω–æ">‚ùå –í–∏–≥–Ω–∞–Ω–æ</option>
            </select>

            <div id="role-field" style="display: none;">
                <label for="role_id">üéñÔ∏è –û–±–µ—Ä—ñ—Ç—å –Ω–æ–≤—É —Ä–æ–ª—å:</label>
                <select class="form-select" name="role_id">
                    {% for name, rid in roles %}
                        <option value="{{ rid }}">{{ name }}</option>
                    {% endfor %}
                </select>
            </div>

            <label for="reason">üìù –ü—Ä–∏—á–∏–Ω–∞ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è):</label>
            <input type="text" name="reason" class="form-control" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –∞–±–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è" required>

            <button type="submit" class="btn btn-success mt-4 w-100">üîÅ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Discord</button>
        </form>

        <div class="mt-4 text-center">
            <a href="/history" class="btn btn-outline-light">üìú –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é</a>
            <a href="/logout" class="btn btn-outline-danger ms-2">üö™ –í–∏–π—Ç–∏</a>
        </div>
    </div>
</div>

<!-- JS for Select2 -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
    function toggleRoleField() {
        const action = document.getElementById("action").value;
        const roleField = document.getElementById("role-field");
        roleField.style.display = (action === "–ó–º—ñ–Ω–∞ —Ä–∞–Ω–≥—É") ? "block" : "none";
    }

    $(document).ready(function () {
        $('.js-user-select').select2({
            width: '100%',
            placeholder: '–ü–æ—á–Ω—ñ—Ç—å –≤–≤–æ–¥–∏—Ç–∏ —ñ–º‚Äô—è...',
            language: {
                noResults: function () {
                    return "–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ";
                }
            }
        });

        toggleRoleField();
    });
</script>
</body>
</html>
