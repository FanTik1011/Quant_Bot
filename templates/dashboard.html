<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard | National Guard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/@ttskch/select2-bootstrap4-theme@1.5.2/dist/select2-bootstrap4.min.css" rel="stylesheet" />
  <style>
    :root{
      --bg-grad1: rgba(88,101,242,.18);
      --bg-grad2: rgba(14,165,233,.16);
      --glass: rgba(11,14,24,.78);
      --glass-strong: rgba(11,14,24,.88);
      --border: rgba(255,255,255,.12);
      --soft: rgba(255,255,255,.85);
      --title: #ffffff;
      --green:#22c55e;
      --green-h:#1fa351;
      --yellow:#fbbf24;
      --sky:#0ea5e9;
      --danger:#ef4444;
      --focus:#8b5cf6;
    }
    body{
      background:
        radial-gradient(1200px 600px at 120% -10%, var(--bg-grad1), transparent 55%),
        radial-gradient(1000px 800px at -20% 120%, var(--bg-grad2), transparent 60%),
        url("/static/bg.jpg") center/cover fixed no-repeat;
      color:#fff; font-family:'Segoe UI', system-ui, -apple-system, sans-serif;
    }

    .wrap{ max-width: 1180px; margin: 40px auto; padding: 0 16px; }

    /* Header */
    .hero{
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      margin-bottom: 18px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .badge-dot{
      width:14px; height:14px; border-radius:50%;
      background: var(--yellow);
      box-shadow: 0 0 16px var(--yellow);
    }
    .hero h1{
      margin:0; font-weight:900; letter-spacing:.2px; color:var(--title);
      text-shadow: 0 12px 26px rgba(0,0,0,.55);
    }
    .hero small{ color: var(--soft) }

    /* Panel */
    .panel{
      position:relative;
      background: var(--glass);
      border:1px solid var(--border);
      border-radius:22px;
      padding:22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
      transition:.25s;
      overflow:hidden;
    }
    .panel:hover{ background: var(--glass-strong) }
    .panel::before{
      content:""; position:absolute; inset:-40%;
      background:
        radial-gradient(700px 360px at 110% -10%, rgba(14,165,233,.18), transparent 55%),
        radial-gradient(700px 360px at -10% 120%, rgba(168,85,247,.12), transparent 55%);
      pointer-events:none; filter: blur(2px);
    }

    .head{
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      margin-bottom: 10px;
    }
    .head h2{ margin:0; font-weight:800; letter-spacing:.2px }
    .sub{ color: var(--soft) }

    .inline-actions{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

    /* Inputs */
    label{ color:#f8fafc; font-weight:700; margin-bottom:.45rem }
    .form-text{ color: var(--soft) }

    .form-control, .form-select{
      background:#ffffff !important; color:#000 !important;
      border:1px solid #d0d7e2 !important; border-radius:.8rem !important;
      padding:.72rem .9rem !important; box-shadow:none !important;
      transition: border-color .15s, box-shadow .15s;
    }
    .form-control:focus, .form-select:focus{
      border-color: #c4b5fd !important;
      box-shadow: 0 0 0 .25rem rgba(139,92,246,.25) !important;
      outline: none;
    }
    textarea.form-control{ min-height: 92px }

    /* Select2 theme tweaks */
    .select2-container--bootstrap4 .select2-selection--single{
      height: 48px !important; padding: 8px 12px !important;
      border-radius:.8rem !important; border:1px solid #d0d7e2 !important;
      background:#fff !important;
      transition: border-color .15s, box-shadow .15s;
    }
    .select2-container--bootstrap4 .select2-selection__rendered{
      color:#000 !important; line-height: 32px !important;
    }
    .select2-container--bootstrap4 .select2-selection__arrow { height: 100% }
    .select2-container--bootstrap4 .select2-results__option{
      color:#000 !important; background:#fff !important;
    }
    .select2-container--bootstrap4 .select2-results__option--highlighted{
      background:#e2e8f0 !important; color:#000 !important;
    }
    .select2-container--bootstrap4.select2-container--focus .select2-selection{
      border-color:#c4b5fd !important; box-shadow: 0 0 0 .25rem rgba(139,92,246,.25) !important;
    }

    /* Buttons */
    .btn-success{
      background: var(--green); border:none; font-weight:800;
      padding:.78rem 1.15rem; border-radius:.9rem; letter-spacing:.2px;
      transition:.2s;
    }
    .btn-success:hover{ background: var(--green-h); transform: translateY(-1px) }
    .btn-outline-light, .btn-outline-danger{
      border-radius:.9rem; font-weight:700; letter-spacing:.2px;
    }

    /* helper */
    .grid{ display:grid; gap:16px; grid-template-columns: 1fr; }
    @media (min-width: 900px){ .grid{ grid-template-columns: 1fr 1fr } .full{ grid-column: 1 / -1 } }

    .soft-line{ border-top:1px dashed var(--border); margin:14px 0 }

    /* Manual link */
    .link-manual{
      color:#93c5fd; cursor:pointer; text-decoration: underline dotted;
      font-weight:600;
    }
    .link-manual:hover{ color:#60a5fa }

    /* Quick chips for action */
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:6px }
    .chip{
      padding:8px 12px; background:#0b1322; border:1px solid var(--border);
      color:#cbd5e1; border-radius:999px; font-weight:700; cursor:pointer; transition:.2s;
    }
    .chip:hover{ transform: translateY(-1px) }
  </style>
</head>
<body>

  <div class="wrap">
    <!-- header -->
    <div class="hero">
      <div class="brand">
        <span class="badge-dot"></span>
        <h1>National Guard ‚Ä¢ –ö–∞–¥—Ä–æ–≤–∏–π –∞—É–¥–∏—Ç</h1>
      </div>
      <small>–û—Ñ—ñ—Ü—ñ–π–Ω–∞ –ø–∞–Ω–µ–ª—å. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Discord OAuth2.</small>
    </div>

    <!-- panel -->
    <div class="panel">
      <div class="head">
        <div>
          <h2>üõ°Ô∏è –ü–∞–Ω–µ–ª—å –¥—ñ–π</h2>
          <div class="sub">–ó–∞—Å—Ç–æ—Å—É–π—Ç–µ –∫–∞–¥—Ä–æ–≤—É –¥—ñ—é ‚Äî –º–∏ –∑–∞–ª–æ–≥—É—î–º–æ —ó—ó —É Discord —ñ –¥–æ–¥–∞–º–æ –¥–æ —ñ—Å—Ç–æ—Ä—ñ—ó.</div>
        </div>
        <div class="inline-actions">
          <a href="/history" class="btn btn-outline-light">üìã –Ü—Å—Ç–æ—Ä—ñ—è</a>
          <a href="/logout" class="btn btn-outline-danger">üö™ –í–∏–π—Ç–∏</a>
        </div>
      </div>

      <div class="soft-line"></div>

      <form method="POST">
        <div class="grid">

          <!-- –ö–æ–≥–æ -->
          <div class="full">
            <label for="user_id">üë§ –ö–æ–≥–æ</label>
            <select class="form-select" id="user_id" name="user_id" required>
              {% for name, uid in members %}
                <option value="{{ uid }}">{{ name }}</option>
              {% endfor %}
            </select>

            <div class="d-flex align-items-center gap-2 mt-2">
              <span class="form-text">–ú–æ–∂–µ—à –æ–±—Ä–∞—Ç–∏ –∑—ñ —Å–ø–∏—Å–∫—É –∞–±–æ</span>
              <span id="toggleManual" class="link-manual">–≤–≤–µ—Å—Ç–∏ Discord ID –≤—Ä—É—á–Ω—É</span>
            </div>

            <input type="text" class="form-control mt-2 d-none" id="manual_user_id"
                   placeholder="–í–≤–µ–¥—ñ—Ç—å Discord ID –≤—Ä—É—á–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 1234567890)">
          </div>

          <!-- –Ü–º‚Äô—è | –°—Ç–∞—Ç–∏—á–Ω–∏–π ID -->
          <div>
            <label for="full_name_id">üÜî –Ü–º‚Äô—è –ü—Ä—ñ–∑–≤–∏—â–µ | –°—Ç–∞—Ç–∏—á–Ω–∏–π ID</label>
            <input type="text" class="form-control" id="full_name_id" name="full_name_id"
                   placeholder="Nei Wayne | 19311" required>
            <div class="form-text">–§–æ—Ä–º–∞—Ç: –Ü–º‚Äô—è –ü—Ä—ñ–∑–≤–∏—â–µ | —Å—Ç–∞—Ç–∏—á–Ω–∏–πID</div>
          </div>

          <!-- –î—ñ—è -->
          <div>
            <label for="action">üìå –î—ñ—è</label>
            <select class="form-select" id="action" name="action" required>
              <option value="–ü—Ä–∏–π–Ω—è—Ç–æ">–ü—Ä–∏–π–Ω—è—Ç–æ</option>
              <option value="–ü—ñ–¥–≤–∏—â–µ–Ω–æ">–ü—ñ–¥–≤–∏—â–µ–Ω–æ</option>
              <option value="–ü–æ–Ω–∏–∂–µ–Ω–æ">–ü–æ–Ω–∏–∂–µ–Ω–æ</option>
              <option value="–í–∏–≥–Ω–∞–Ω–æ">–í–∏–≥–Ω–∞–Ω–æ</option>
            </select>
            <!-- —à–≤–∏–¥–∫—ñ —á—ñ–ø–∏-–ø—ñ–¥–∫–∞–∑–∫–∏ -->
            <div class="chips">
              <span class="chip" data-action="–ü—Ä–∏–π–Ω—è—Ç–æ">+ –ü—Ä–∏–π–Ω—è—Ç–æ</span>
              <span class="chip" data-action="–ü—ñ–¥–≤–∏—â–µ–Ω–æ">‚¨Ü –ü—ñ–¥–≤–∏—â–µ–Ω–æ</span>
              <span class="chip" data-action="–ü–æ–Ω–∏–∂–µ–Ω–æ">‚¨á –ü–æ–Ω–∏–∂–µ–Ω–æ</span>
              <span class="chip" data-action="–í–∏–≥–Ω–∞–Ω–æ">‚úñ –í–∏–≥–Ω–∞–Ω–æ</span>
            </div>
          </div>

          <!-- –ù–æ–≤–∞ —Ä–æ–ª—å -->
          <div class="full">
            <label for="role_name">üéñÔ∏è –ù–æ–≤–∞ —Ä–æ–ª—å (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏)</label>
            <input type="text" class="form-control" id="role_name" name="role_name"
                   placeholder="–†–µ–∫—Ä—É—Ç, –ö–∞–¥–µ—Ç, ...">
            <div class="form-text">–ó–∞–ª–∏—à –ø–æ—Ä–æ–∂–Ω—ñ–º, —è–∫—â–æ —Ä–æ–ª—å –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è.</div>
          </div>

          <!-- –ü—Ä–∏—á–∏–Ω–∞ -->
          <div class="full">
            <label for="reason">üìù –ü—Ä–∏—á–∏–Ω–∞ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –∞–±–æ –∫–æ–º–µ–Ω—Ç–∞—Ä)</label>
            <textarea class="form-control" id="reason" name="reason" rows="2"
                      placeholder="https://... –∞–±–æ '–ù–∞–∫–∞–∑ ‚Ññ1 –≤—ñ–¥ 20.07.2025'"></textarea>
          </div>
        </div>

        <div class="d-flex align-items-center mt-3 gap-2">
          <button type="submit" class="btn btn-success">‚úÖ –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥—ñ—é</button>
          <a href="/history" class="btn btn-outline-light">üìã –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é</a>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script>
    $(function () {
      // Select2
      const $sel = $('#user_id').select2({
        theme: 'bootstrap4',
        placeholder: "–û–±–µ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –≤–ø–∏—à—ñ—Ç—å –≤—Ä—É—á–Ω—É",
        width: '100%',
        tags: true,
        createTag: params => ({ id: params.term, text: params.term, newOption: true }),
        insertTag: (data, tag) => data.push(tag)
      });

      // Manual Discord ID
      const $manual = $('#manual_user_id');
      $('#toggleManual').on('click', function(){
        $manual.toggleClass('d-none');
        if (!$manual.hasClass('d-none')) { $manual.focus(); }
      });

      $manual.on('keydown', function(e){
        if (e.key === 'Enter') { e.preventDefault(); commitManual(); }
      }).on('blur', commitManual);

      function commitManual(){
        const val = $manual.val().trim();
        if (!val) return;
        // –¥–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π —Ç–µ–≥ —É select2 —ñ –æ–±–∏—Ä–∞—î–º–æ –π–æ–≥–æ
        const newOption = new Option(val, val, true, true);
        $('#user_id').append(newOption).trigger('change');
        $manual.addClass('d-none');
      }

      // Quick chips ‚Üí –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É select#action
      $('.chip').on('click', function(){
        const v = $(this).data('action');
        $('#action').val(v).trigger('change');
      });
    });
  </script>
</body>
</html>
